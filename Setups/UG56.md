# Milesight UG56 Gateway Setup ‚Äî Integration with ChirpStack

> üì∫ Reference: [How to Integrate Milesight IoT Gateway and Sensor into ChirpStack Server](https://www.youtube.com/watch?v=6WN-BnupL0o&t=219s)

---

## üìã Prerequisites

- Milesight UG56 gateway powered on and connected to the local network
- ChirpStack running and accessible (see [`Raspberrypi.md`](./Raspberrypi.md))
- Your LoRaWAN frequency plan (e.g., EU868, US915)

---

## üåê Step 1: Access the UG56 Web Interface

1. Find the gateway's IP address (check your router's DHCP table or the label on the device)
2. Open a browser and navigate to:

   ```
   http://<UG56_IP_ADDRESS>
   ```

3. Log in with the default credentials:

| Field    | Default Value |
|----------|---------------|
| Username | `admin`       |
| Password | `password`    |

> ‚ö†Ô∏è Change the default password after the first login.

---

## üì° Step 2: Configure the Packet Forwarder

1. Go to **Packet Forwarder** ‚Üí **General**
2. Set the following:

| Field              | Value                          |
|--------------------|--------------------------------|
| Protocol           | `Semtech UDP GWMP Protocol`    |
| Server Address     | IP of your Raspberry Pi        |
| Server Port (Up)   | `1700`                         |
| Server Port (Down) | `1700`                         |

3. Click **Save & Apply**

---

## üó∫Ô∏è Step 3: Set the Frequency Plan

1. Go to **Packet Forwarder** ‚Üí **Radio**
2. Select your region's frequency plan (e.g., `EU868`, `US915`, `AS923`)
3. Click **Save & Apply**

> The frequency plan on the UG56 **must match** the region configured in ChirpStack.

---

## üñ•Ô∏è Step 4: Register the Gateway in ChirpStack

1. Open the ChirpStack web UI:

   ```
   http://<RASPBERRY_PI_IP>:8080
   ```

2. Log in as `admin`
3. Navigate to **Gateways** ‚Üí **Add Gateway**
4. Fill in the required fields:

| Field          | Value                                                              |
|----------------|--------------------------------------------------------------------|
| Name           | Any descriptive name (e.g., `UG56-Gateway`)                        |
| Gateway EUI    | Found in the UG56 web UI under **Overview** or **Packet Forwarder** |
| Description    | Optional                                                           |
| Network Server | Select your configured network server                              |

5. Click **Create Gateway**

---

## ‚úÖ Step 5: Verify the Connection

1. In ChirpStack, go to **Gateways** and select your gateway
2. Check the **Last seen** field ‚Äî it should update within a few seconds if the gateway is forwarding packets correctly
3. On the Raspberry Pi, you can also verify incoming UDP traffic:

   ```bash
   sudo tcpdump -AUq port 1700
   ```

   You should see packets arriving from the UG56's IP address.

---

## üìü Step 6: Register an End Device (Sensor)

1. In ChirpStack, go to **Applications** ‚Üí **Add Application** (or select an existing one)
2. Inside the application, go to **Devices** ‚Üí **Add Device**
3. Fill in the device details:

| Field          | Value                                      |
|----------------|--------------------------------------------|
| Name           | Name for the sensor                        |
| Device EUI     | Printed on the sensor or from its manual   |
| Device Profile | Select the appropriate LoRaWAN profile     |

4. After creating the device, go to the **Keys (OTAA)** tab and enter the **Application Key** from the sensor
5. Power on the sensor ‚Äî it should join the network and appear as **Active** in ChirpStack

---

## üîó Next Steps

- Forward device data to **Azure IoT Hub** (see integration guide)
- Set up **dashboards** or **decoders** for your sensor payloads in ChirpStack